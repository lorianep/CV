<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV de Loriane P. - Ingénieur Infra</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #007bff; /* Bleu profond et professionnel */
            --secondary-color: #f0f8ff; /* Bleu très clair pour le fond du bandeau */
            --text-color: #333;
            --light-text-color: #666;
            --header-text-color: #fff;
            --font-main: 'Roboto', sans-serif; 
            --font-alt: 'Open Sans', sans-serif;
        }

        /* Import de polices Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;600&display=swap');

        body {
            font-family: var(--font-main);
            color: var(--text-color);
            line-height: 1.4; /* Ligne hauteur réduite */
            margin: 0;
            padding: 0; 
            background-color: #f0f2f5; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .cv-container {
            display: flex;
            width: 21cm; /* Format A4 */
            height: 29.7cm; /* Format A4 */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            background-color: white;
            position: relative; 
        }

        /* BANDEAU LATÉRAL GAUCHE */
        .sidebar {
            width: 35%; 
            background-color: var(--primary-color);
            color: var(--header-text-color);
            padding: 25px 20px; /* Padding réduit (OPTIMISATION) */
            box-sizing: border-box; 
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .sidebar h1 {
            font-family: var(--font-main);
            font-weight: 700;
            font-size: 2.1em; /* Taille réduite */
            margin-bottom: 3px; /* Marge réduite */
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sidebar h2 {
            font-family: var(--font-main);
            font-weight: 400;
            font-size: 1.05em; /* Taille réduite */
            margin-top: 0;
            margin-bottom: 25px; /* Marge réduite */
            color: rgba(255, 255, 255, 0.9);
        }

        .sidebar h3 { /* Titres de section dans la sidebar */
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 6px; /* Padding réduit */
            margin-top: 30px; /* Marge réduite (OPTIMISATION) */
            margin-bottom: 12px; /* Marge réduite (OPTIMISATION) */
            font-size: 1.15em; /* Taille réduite */
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--header-text-color);
            width: 100%;
        }

        .sidebar .contact-info,
        .sidebar .skills-list,
        .sidebar .languages {
            width: 100%;
            text-align: left; 
        }

        .sidebar .contact-info p,
        .sidebar .languages p {
            margin-bottom: 6px; /* Marge réduite */
            font-size: 0.9em; /* Taille réduite */
            display: flex;
            align-items: flex-start; 
        }
        .sidebar .contact-info i,
        .sidebar .languages i {
            margin-right: 8px; /* Marge réduite */
            color: var(--secondary-color); 
            font-size: 1.05em; 
            margin-top: 2px; 
        }
        .sidebar .contact-info a {
            color: var(--header-text-color);
            text-decoration: none;
            word-break: break-all; 
        }
        .sidebar .contact-info a:hover {
            text-decoration: underline;
        }

        .sidebar .skills-list {
            list-style: none;
            padding: 0;
            margin-top: 8px; /* Marge réduite */
            display: flex;
            flex-wrap: wrap; 
            gap: 4px; /* Gap réduit */
        }
        .sidebar .skills-list li {
            background-color: rgba(255, 255, 255, 0.1); 
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 5px 10px; /* Padding réduit */
            border-radius: 20px;
            font-size: 0.85em; /* Taille réduite */
            white-space: nowrap;
        }
        .sidebar .skills-list li strong {
            color: var(--secondary-color);
        }

        /* CONTENU PRINCIPAL DROIT */
        .main-content {
            width: 65%; 
            padding: 25px 35px; /* Padding réduit (OPTIMISATION) */
            box-sizing: border-box;
            background-color: white;
            overflow: hidden; 
        }

        .main-content h2 { 
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 6px; /* Padding réduit */
            margin-top: 20px; /* Marge réduite (OPTIMISATION) */
            margin-bottom: 12px; /* Marge réduite (OPTIMISATION) */
            font-size: 1.3em; /* Taille réduite */
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }
        .main-content h2:first-of-type {
            margin-top: 0; 
        }
        .main-content h2 i {
            margin-right: 8px; /* Marge réduite */
            font-size: 1.05em;
            color: var(--primary-color);
        }
        
        /* Accroche (Profil) */
        .profile-section p {
            margin-bottom: 0; /* Supprimer la marge sous l'accroche */
            font-size: 0.95em;
        }


        /* Expériences / Formations */
        .experience-item, .education-item {
            margin-bottom: 15px; /* Marge réduite (OPTIMISATION) */
        }
        .item-header {
            margin-bottom: 2px; /* Marge réduite */
        }
        .item-title {
            font-weight: 600;
            font-size: 1em; /* Taille légèrement réduite */
        }
        .item-company, .item-establishment {
            font-size: 0.9em; /* Taille légèrement réduite */
            margin-bottom: 3px;
        }
        .item-date {
            font-size: 0.8em; /* Taille réduite */
        }
        .item-tasks {
            padding-left: 18px; /* Padding réduit */
            margin-top: 3px; /* Marge réduite */
            font-size: 0.88em; /* Taille légèrement réduite */
        }
        .item-tasks li {
            margin-bottom: 0px; /* Marge minimale (OPTIMISATION) */
        }

        /* BOUTON PDF (Affiché en bas à droite, positionné absolument) */
        .pdf-button {
            position: absolute;
            bottom: 15px; /* Position ajustée */
            right: 20px; /* Position ajustée */
            padding: 8px 15px; /* Padding réduit */
            background-color: #28a745; 
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.9em; /* Taille réduite */
            cursor: pointer;
            z-index: 10; 
            transition: background-color 0.3s ease;
        }
        .pdf-button:hover {
            background-color: #218838;
        }
        .pdf-button i {
            margin-right: 6px; 
        }


        /* AJUSTEMENTS POUR L'IMPRESSION (PDF) */
        @media print {
            body {
                background-color: white !important;
                line-height: 1.3; /* Ligne hauteur encore plus réduite pour le PDF */
            }
            .cv-container {
                /* S'assure que le contenu est forcé dans les limites de l'A4 */
                width: 210mm; 
                height: 297mm; 
                padding: 0;
            }
            .sidebar, .main-content {
                padding: 20px 18px; /* Padding minimal pour l'impression */
                height: 100%;
                overflow: hidden; 
            }
            .pdf-button {
                display: none !important; 
            }
            /* Assurer l'absence de coupure dans les sections */
            h2, h3, .experience-item, .education-item {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="cv-container">
        <div class="sidebar" id="cv-sidebar">
            <h1></h1>
            <h2></h2>
            <section class="contact-info"></section>
            <section class="skills-section"></section>
            <section class="languages-section"></section>
        </div>

        <div class="main-content">
            <section class="profile-section"></section>
            <section class="experiences-section"></section>
            <section class="education-section"></section>
            <button class="pdf-button" onclick="window.print()">
                <i class="fas fa-download"></i> TÉLÉCHARGER LE CV EN PDF
            </button>
        </div>
    </div>

    <script>
        function renderCV(data) {
            const sidebar = document.getElementById('cv-sidebar');
            const mainContent = document.querySelector('.main-content');
            const contact = data.profil.contact;

            // --- PARTIE GAUCHE (SIDEBAR) ---
            // Nom et Titre
            sidebar.querySelector('h1').innerText = `${data.profil.nom} ${data.profil.prenom}`;
            sidebar.querySelector('h2').innerText = data.profil.titre;

            // Contact Info (vérifie l'existence de chaque clé)
            const contactInfo = sidebar.querySelector('.contact-info');
            // J'ajoute l'email, il sera affiché seulement si la clé existe et a une valeur. Si vous la supprimez du JSON, elle n'apparaîtra plus.
            contactInfo.innerHTML = `<h3><i class="fas fa-id-badge"></i> CONTACT</h3>
                ${contact.email ? `<p><i class="fas fa-envelope"></i> <a href="mailto:${contact.email}">${contact.email}</a></p>` : ''}
                ${contact.linkedin ? `<p><i class="fab fa-linkedin"></i> <a href="${contact.linkedin}" target="_blank">LinkedIn</a></p>` : ''}
                ${contact.github ? `<p><i class="fab fa-github"></i> <a href="${contact.github}" target="_blank">GitHub</a></p>` : ''}
                ${contact.localisation ? `<p><i class="fas fa-map-marker-alt"></i> ${contact.localisation}</p>` : ''}
            `;

            // Compétences
            const skillsSection = sidebar.querySelector('.skills-section');
            let skillsHTML = `<h3><i class="fas fa-cogs"></i> COMPÉTENCES</h3><ul class="skills-list">`;
            
            const allSkills = [
                ...(data.competences.infra || []),
                ...(data.competences.reseau_securite || []),
                ...(data.competences.automatisation_devops || []),
                ...(data.competences.base_donnees_monitoring || []),
                ...(data.competences.cloud || [])
            ];
            skillsHTML += allSkills.map(skill => `<li>${skill.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</li>`).join('');
            skillsHTML += `</ul>`;
            skillsSection.innerHTML = skillsHTML;

            // Langues
            const languagesSection = sidebar.querySelector('.languages-section');
            if (data.competences.langues && data.competences.langues.length > 0) {
                let languagesHTML = `<h3><i class="fas fa-language"></i> LANGUES</h3>`;
                data.competences.langues.forEach(lang => {
                    languagesHTML += `<p>${lang}</p>`;
                });
                languagesSection.innerHTML = languagesHTML;
            }


            // --- PARTIE DROITE (MAIN CONTENT) ---
            // Profil / Accroche
            const profileSection = mainContent.querySelector('.profile-section');
            profileSection.innerHTML = `
                <h2><i class="fas fa-user-circle"></i> PROFIL</h2>
                <p>${data.profil.accroche}</p>
            `;

            // Expériences
            const experiencesSection = mainContent.querySelector('.experiences-section');
            experiencesSection.innerHTML = `<h2><i class="fas fa-briefcase"></i> EXPÉRIENCES PROFESSIONNELLES</h2>`;
            data.experiences.forEach(exp => {
                const tasksList = exp.taches ? exp.taches.map(task => `<li>${task}</li>`).join('') : '';
                experiencesSection.innerHTML += `
                    <div class="experience-item">
                        <div class="item-header">
                            <span class="item-title">${exp.titre}</span>
                            <span class="item-date">${exp.duree}</span>
                        </div>
                        <p class="item-company">${exp.entreprise}</p>
                        ${tasksList ? `<ul class="item-tasks">${tasksList}</ul>` : ''}
                    </div>
                `;
            });

            // Formations
            const educationSection = mainContent.querySelector('.education-section');
            educationSection.innerHTML = `<h2><i class="fas fa-graduation-cap"></i> FORMATION</h2>`;
            data.formations.forEach(form => {
                educationSection.innerHTML += `
                    <div class="education-item">
                        <div class="item-header">
                            <span class="item-title">${form.titre}</span>
                            <span class="item-date">${form.duree}</span>
                        </div>
                        <p class="item-establishment">${form.etablissement}</p>
                    </div>
                `;
            });
        }

        // Chargement des données JSON et rendu
        fetch('./cv-data.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Erreur de chargement de cv-data.json: ' + response.statusText);
                }
                return response.json();
            })
            .then(data => renderCV(data))
            .catch(error => {
                console.error(error);
                document.querySelector('.cv-container').innerHTML = "<div style='padding: 50px; text-align: center; color: red;'><h2>Erreur de chargement des données. Veuillez vérifier le fichier cv-data.json ou son chemin (utiliser Live Server en local).</h2></div>";
            });
    </script>
</body>
</html>
